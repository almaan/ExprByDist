geom_smooth(method=lm, alpha = 0.2,formula = y ~ poly(x, 5, raw=TRUE)) +
geom_point()  +
scale_color_manual(values=cmap) +
xlab('Distance') +
ylab('Expression') +
title(plt_title)
print(viz)
viz <- ggplot(data = data_long, aes(x = distance, y = expression, color = gene)) +
annotate('rect', xmin = -Inf, xmax = 0, ymin = -Inf, ymax = Inf, fill = "red", color = NA, alpha = 0.1) +
annotate('rect', xmin = 0, xmax = Inf, ymin = -Inf, ymax = Inf, fill = "green", color = NA, alpha = 0.1) +
geom_smooth(method=lm, alpha = 0.2,formula = y ~ poly(x, 5, raw=TRUE)) +
geom_point()  +
scale_color_manual(values=cmap) +
xlab('Distance') +
ylab('Expression') +
ggtitle(plt_title)
print(viz)
viz <- ggplot(data = data_long, aes(x = distance, y = expression, color = gene)) +
ggtitle(plt_title) +
annotate('rect', xmin = -Inf, xmax = 0, ymin = -Inf, ymax = Inf, fill = "red", color = NA, alpha = 0.1) +
annotate('rect', xmin = 0, xmax = Inf, ymin = -Inf, ymax = Inf, fill = "green", color = NA, alpha = 0.1) +
geom_smooth(method=lm, alpha = 0.2,formula = y ~ poly(x, 5, raw=TRUE)) +
geom_point()  +
scale_color_manual(values=cmap) +
xlab('Distance') +
ylab('Expression')
print(viz)
viz <- ggplot(data = data_long, aes(x = distance, y = expression, color = gene)) +
ggtitle(plt_title) +
annotate('rect', xmin = -Inf, xmax = 0, ymin = -Inf, ymax = Inf, fill = "red", color = NA, alpha = 0.1) +
annotate('rect', xmin = 0, xmax = Inf, ymin = -Inf, ymax = Inf, fill = "green", color = NA, alpha = 0.1) +
geom_smooth(method=lm, alpha = 0.2,formula = y ~ poly(x, 5, raw=TRUE)) +
geom_point()  +
scale_color_manual(values=cmap) +
xlab('Distance') +
ylab('Expression') +
theme(plot.title = element_text(hjust = 0.5))
print(viz)
viz <- ggplot(data = data_long, aes(x = distance, y = expression, color = gene)) +
ggtitle(plt_title) +
annotate('rect', xmin = -Inf, xmax = 0, ymin = -Inf, ymax = Inf, fill = "red", color = NA, alpha = 0.1) +
annotate('rect', xmin = 0, xmax = Inf, ymin = -Inf, ymax = Inf, fill = "green", color = NA, alpha = 0.1) +
geom_smooth(method=lm, alpha = 0.2,formula = y ~ poly(x, 5, raw=TRUE)) +
geom_point()  +
scale_color_manual(values=cmap) +
xlab('Distance') +
ylab('Expression') +
theme(plot.title = element_text(hjust = 0.5))
ll <-  y ~ poly(x, polydeg, raw=TRUE)
ll
library(futile.logger)
flog.info(sprintf('testr %s', 'dfdf'))
data
boxplot(data)
boxplot(dataf)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
spotcount
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
spotcount
dim(spotcount)
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
spotcount
sptocountf <- spotcount[spotcount > 0]
spotcountf
sptcountf
asptocountf <- spotcount[spotcount > 0]
a <- spotcount[spotcount > 0]
a
bar(a)
barplot(a)
dev.off()
barplot(a)
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
spotcountf$distance <- as.numeric(rownames(spotcount))
dev.off()
spotcountf <- spotcount[keepdist,]
spotcountf$distance <- as.numeric(rownames(spotcount))
spotcountf
spotcount
keepdist
spotcount[keepdist]
spotcount[keepdist,]
spotcount[keepdist,1]
a[] <- spotcount[keepdist,1]
a
spotcount$distance <- as.numeric(rownames(spotcount))
spotcountf <- spotcount[keepdist,]
spotcountf
bp <- ggplot(data = spotcountf, aes(x = distance, y = n_spots )) +
+ geom_bar()
bp <- ggplot(data = spotcountf, aes(x = distance, y = n_spots )) +
geom_bar()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_histogramr()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_histogram()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance, y = n_spots)) +
geom_histogram()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_histogram()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar()
print(bp)
spotcountf
df <- data.frame(x = rep(c(2.9, 3.1, 4.5), c(5, 10, 4)))
df
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity')
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', width = 10)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', width = 3)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', width = 2)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', binwidth = 1)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', binwidth = 1)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity')
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity')
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 0.2)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 1.0)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 1.0)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = .5)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = .5)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = .3)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = .3)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity')
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 1.0)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 0.9)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 0.6)
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 0.6, fill = 'red', color = 'black')
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity',width = 0.2, fill = 'red', color = 'black')
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_histogram(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black')
print(bp)
spotcountf
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_discrete(aes(breaks =distance) )
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_discrete(breaks = spotcountf$distance)
print(bp)
distance
spotcountf$distance
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_discrete(breaks = c(1:nrow(spotcountf)), aes(labels = distance))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_discrete(breaks = c(1:nrow(spotcountf)), labels = as.character(spotcountf$distance))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_continuous(breaks = c(1:nrow(spotcountf)), labels = as.character(spotcountf$distance))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_continuous(aes(breaks = distance))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
scale_x_continuous(aes(breaks = distance, labels = distance))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_c_continous(breaks = number_ticks(nrow(spotcountf)))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continous(breaks = number_ticks(nrow(spotcountf)))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continuous(breaks = number_ticks(nrow(spotcountf)))
print(bp)
number_ticks <- function(n) {function(limits) pretty(limits, n)}
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continuous(breaks = number_ticks(nrow(spotcountf)))
print(bp)
number_ticks <- function(n) {function(limits) pretty(limits, n)}
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continuous(breaks = 1:100)
print(bp)
number_ticks <- function(n) {function(limits) pretty(limits, n)}
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continuous(breaks = seq(1:100,0.5))
print(bp)
number_ticks <- function(n) {function(limits) pretty(limits, n)}
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black') +
#scale_x_continuous(aes(breaks = distance, labels = distance))
scale_x_continuous(breaks = seq(1,100,0.5))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = position_nudge(x = 0.5))
print(bp)
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = position_nudge(x = 0.5))
print(bp)
print(bp)
dev.off()
dev.off()
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = position_nudge(x = 0.5))
print(bp)
dev.off()
dev.off()
dev.off()
dev.off()
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = position_nudge(x = 0.5))
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots,position = distance),stat = 'identity', fill = 'red', color = 'black')
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),position =  sptcountf$distance,stat = 'identity', fill = 'red', color = 'black')
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),position =  spotcountf$distance,stat = 'identity', fill = 'red', color = 'black')
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black')
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black')
+ scale_x_continuous(breaks =  spotcountf$distance)
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = )
+ scale_x_continuous(breaks =  spotcountf$distance)
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(x=distance, y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = )
+ scale_x_discrete(breaks =  spotcountf$distance)
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(y = n_spots),stat = 'identity', fill = 'red', color = 'black', position = )
+ scale_x_discrete(breaks =  spotcountf$distance)
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = distance)) +
geom_bar(aes(y = n_spots),stat = 'identity', fill = 'red', color = 'black')
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots),stat = 'identity', fill = 'red', color = 'black' )
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' )
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#132B43", high = "#56B1F7",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#541e00", high = "#efd3ff",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
#png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
theme_dark()
print(bp)
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
theme_dark()
print(bp)
dev.off()
getwd()
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
theme_bw()
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
theme_bw()
print(bp)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
print(bp)
dev.off()
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#420800", high = "#ddc000",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
print(bp)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#847f77", high = "#847f77",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
print(bp)
dev.off()
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#847f77", high = "#847f77",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill") +
print(bp)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#847f77", high = "#847f77",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#897b64", high = "#fc05b",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#897b64", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#ffc463", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
dev.off()
dev.off()
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#ffc463", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
dev.off()
dev.off()
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#897b64", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
dev.off()
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'))
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#966d2a", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
dev.off()
dev.off()
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'),
width = 1000,
height = 500)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#966d2a", high = "#ffc463",
space = "Lab", na.value = "grey50", guide = "colourbar",
aesthetics = "fill")
print(bp)
dev.off()
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'),
width = 1000,
height = 500)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#966d2a",
high = "#ffc463",
space = "Lab",
na.value = "grey50",
guide = "Number of Spots",
aesthetics = "fill")
print(bp)
print(bp)
spotcountf
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#966d2a",
high = "#ffc463",
space = "Lab",
na.value = "grey50",
aesthetics = "fill")
print(bp)
dev.off()
dev.off()
png(paste(c(imgpth,"spot_distribution.png"),collapse = '.'),
width = 1000,
height = 500)
bp <- ggplot(data = spotcountf, aes(x = as.factor(distance))) +
geom_bar(aes(y = n_spots, fill = n_spots),stat = 'identity', color = 'black' ) +
scale_fill_gradient(low = "#966d2a",
high = "#ffc463",
space = "Lab",
na.value = "grey50",
aesthetics = "fill")
print(bp)
dev.off()
source('~/ST-2018/CNNp/ExprByDist/main.r', echo=TRUE)
y <- c('hej','da')
y
paste0(y)
